<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Hugo 0.66.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
  <link rel="stylesheet" href="../css/normalize.css">
  <link rel="stylesheet" href="../css/skeleton.css">
  <link rel="stylesheet" href="../css/custom.css">
  <link rel="alternate" href="index.xml" type="application/rss+xml" title="Speech Research">
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
  <title>Museformer: Transformer with Fine- and Coarse-Grained Attention for Music Generation</title>
</head>

<body>

  <div class="container">

    <header role="banner">

    </header>


    <main role="main">
      <article itemscope itemtype="https://schema.org/BlogPosting">
        <h1 class="entry-title" itemprop="headline">Museformer: Transformer with Fine- and Coarse-Grained Attention for
          Music Generation</h1>

        <section itemprop="entry-text">
          <br>
          <!-- <p>ArXiv: <a href="https://arxiv.org/pdf/2109.09617.pdf">arXiv:2109.09617</a></p> -->
          <h2 id="authors">Authors</h2>
          <ul>
            <li>Botao Yu (Nanjing University) <a href="mailto:btyu@foxmail.com">btyu@foxmail.com</a></li>
            <li>Peiling Lu (Microsoft Research Asia) <a href="mailto:peil@microsoft.com">peil@microsoft.com</a></li>
            <li>Rui Wang (Microsoft Research Asia) <a href="mailto:ruiwa@microsoft.com">ruiwa@microsoft.com</a></li>
            <li>Wei Hu^ (Nanjing University) <a href="mailto:whu@nju.edu.cn">whu@nju.edu.cn</a></li>
            <li>Xu Tan^ (Microsoft Research Asia) <a href="mailto:xuta@microsoft.com">xuta@microsoft.com</a></li>
            <li>Wei Ye (Peking University) <a href="mailto:wye@pku.edu.cn">wye@pku.edu.cn</a></li>
            <li>Shikun Zhang (Peking University) <a href="mailto:zhangsk@pku.edu.cn">zhangsk@pku.edu.cn</a></li>
            <li>Tao Qin (Microsoft Research Asia ) <a href="mailto:taoqin@microsoft.com">taoqin@microsoft.com</a></li>
            <li>Tie-Yan Liu (Microsoft Research Asia) <a href="mailto:tyliu@microsoft.com">tyliu@microsoft.com</a></li>
          </ul>
          <p><small>^ Corresponding author.</small></p>
          <h2 id="abstract">Abstract</h2>
          <p>Symbolic music generation aims to generate music scores automatically.
            A recent trend is to use Transformer or its variants in music generation, which is, however, suboptimal,
            because the full attention cannot efficiently model the typically long music sequences (e.g., over 10,000
            tokens), and the existing models have shortcomings in generating musical repetition structures.
            In this paper, we propose Museformer, a Transformer with a novel fine- and coarse-grained attention for
            music generation.
            Specifically, with the fine-grained attention, a token of a specific bar directly attends to all the tokens
            of the bars that are most relevant to music structures (e.g., the previous 1st, 2nd, 4th and 8th bars,
            selected via similarity statistics);
            with the coarse-grained attention, a token only attends to the summarization of the other bars rather than
            each token of them so as to reduce the computational cost.
            The advantages are two-fold.
            First, it can capture both music structure-related correlations via the fine-grained attention, and other
            contextual information via the coarse-grained attention.
            Second, it is efficient and can model over 3X longer music sequences compared to its full-attention
            counterpart.
            Both objective and subjective experimental results demonstrate its ability to generate long music sequences
            with high quality and better structures.</p>
          

          <h2 id="museformer-samples">Museformer Samples</h2>
          
          <h3>Demo 1  (<a href="../audio/museformer/midi/mf/mf_demo1.mid">midi</a>)</h3> 

          <video width="100%" height="auto" controls >
            <source src="../audio/museformer/video/mf_demo1.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="../audio/museformer/audio/mf/mf_demo1.mp3" autoplay />Your browser does not support the audio element.
          </audio>
          
          
          <h3>Demo 2  (<a href="../audio/museformer/midi/mf/mf_demo2.mid">midi</a>)</h3>

          <video width="100%" height="auto" controls >
            <source src="../audio/museformer/video/mf_demo2.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="../audio/museformer/audio/mf/mf_demo2.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h3>Demo 3  (<a href="../audio/museformer/midi/mf/mf_demo3.mid">midi</a>)</h3>

          <video width="100%" height="auto" controls >
            <source src="../audio/museformer/video/mf_demo3.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="../audio/museformer/audio/mf/mf_demo3.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h3>Demo 4  (<a href="../audio/museformer/midi/mf/mf_demo4.mid">midi</a>)</h3>

          <video width="100%" height="auto" controls >
            <source src="../audio/museformer/video/mf_demo4.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="../audio/museformer/audio/mf/mf_demo4.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h2>Baseline Models</h2>
          <p>Here are music pieces generated by the baseline models:</p>

          <table>

            <tbody>
              <tr>
                <td style="text-align: left">Music Transformer</td>
                <td><audio controls="controls">
                    <source src="../audio/museformer/audio/mt/mt_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="../audio/museformer/midi/mt/mt_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Transformer-XL</td>
                <td><audio controls="controls">
                    <source src="../audio/museformer/audio/xl/xl_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="../audio/museformer/midi/xl/xl_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Longformer</td>
                <td><audio controls="controls">
                    <source src="../audio/museformer/audio/longformer/longformer_demo.mp3" autoplay />Your browser does not support the audio
                    element.
                  </audio></td>
                <td><a href="../audio/museformer/midi/longformer/longformer_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Linear Transformer</td>
                <td><audio controls="controls">
                    <source src="../audio/museformer/audio/linear/linear_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="../audio/museformer/midi/linear/linear_demo.mid">midi</a></td>
              </tr>
            </tbody>
          </table>

          <br /><br />
          <p>Thank you for watching &#128151;!</p>

        </section>
      </article>
    </main>

  </div>

  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-139981676-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>



  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
         HTML: ["input/TeX","output/HTML-CSS"],
         TeX: {
                Macros: {
                         bm: ["\\boldsymbol{#1}", 1],
                         argmax: ["\\mathop{\\rm arg\\,max}\\limits"],
                         argmin: ["\\mathop{\\rm arg\\,min}\\limits"]},
                extensions: ["AMSmath.js","AMSsymbols.js"],
                equationNumbers: { autoNumber: "AMS" } },
         extensions: ["tex2jax.js"],
         jax: ["input/TeX","output/HTML-CSS"],
         tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true },
         "HTML-CSS": { availableFonts: ["TeX"],
                       linebreaks: { automatic: true } }
     });
 </script>

  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
       }
     });
 </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>




</body>

</html>